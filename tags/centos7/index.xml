<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>centos7 on InkCat博客</title><link>https://ink-kai.github.io/tags/centos7/</link><description>Recent content in centos7 on InkCat博客</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Sat, 11 Jun 2022 11:49:46 +0800</lastBuildDate><atom:link href="https://ink-kai.github.io/tags/centos7/index.xml" rel="self" type="application/rss+xml"/><item><title>记-centos文件系统损坏导致部分服务无法使用</title><link>https://ink-kai.github.io/posts/2022/06/11/centossystembug/</link><pubDate>Sat, 11 Jun 2022 11:49:46 +0800</pubDate><guid>https://ink-kai.github.io/posts/2022/06/11/centossystembug/</guid><description>序 不得不处理了，再也不能通过重装解决这个问题了。 本地虚拟机安装的centos7系统出现故障了，修复的时候忘记录了，只能通过文字描述。本文图片不实，但是问题都是一样的
找到问题所在 登录centos系统后，提示以下错误 解释一下这段什么意思？
第二行是说：xfs(dm-0)检测到元数据损坏。 生成的错误日志保存在“/run/in itramfs/rdsosreport.txt”
dm-0是centos系统中挂载的文件系统，可以通过ls -l /dev/mapper查看，dm-0是从/dev挂的一个软连接 OK，找到问题所在。文件系统dm-0元数据损坏
解决问题 需要准备centos镜像文件，开机时进入到紧急救援模式。一定要准备centos镜像iso 按c进入命令模式，输入exit 选择troubleshooting（解决故障） 选择rescue a centos system（救援模式） 选择3（进入shell）
大致翻译下：救援模式试图找到你的linux系统并挂载的以下目录：/mnt/sysimage。你可以对其进行更改你的系统 选择步骤1，继续执行此步骤。 选择步骤2，可以让你的文件系统保持只读状态 选择步骤3，进入内核（shell） 选择步骤4，重启 查看需要修复的文件系统ls -l /dev/mapper xfs_repair是对xfs系统进行修复的一个命令 -d 紧急修复（针对文件系统，我也不是很清楚，但是文件系统只能使用该选项进行处理，否则无法修复file system） -L 强制清空日志。生产环境勿用（请备份文件） 先卸载文件系统umount /dev/dm-0 -v 使用xfs_repair修复xfs_repair -d /dev/dm-0（这里必须使用到-d）
虽然最后还是提示：找不到有效的次要数据块。注意，secondary只是代表次要，metadata主要元数据已经修复
在我看来，次要数据块应该是用户数据和服务日志丢失
重启centos再进入系统就好了！！！</description></item></channel></rss>